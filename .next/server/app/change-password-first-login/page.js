(()=>{var e={};e.id=586,e.ids=[586],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55137:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.ZP,__next_app__:()=>u,originalPathname:()=>c,pages:()=>d,routeModule:()=>m,tree:()=>l});var r=t(50482),a=t(69108),n=t(83543),o=t(68300),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);t.d(s,i);let l=["",{children:["change-password-first-login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,560)),"C:\\Users\\guilherme.almeida\\Documents\\GitHub\\Gestao-Atletas-front\\src\\app\\change-password-first-login\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,94072)),"C:\\Users\\guilherme.almeida\\Documents\\GitHub\\Gestao-Atletas-front\\src\\app\\change-password-first-login\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,56887)),"C:\\Users\\guilherme.almeida\\Documents\\GitHub\\Gestao-Atletas-front\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,24117)),"C:\\Users\\guilherme.almeida\\Documents\\GitHub\\Gestao-Atletas-front\\src\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\guilherme.almeida\\Documents\\GitHub\\Gestao-Atletas-front\\src\\app\\change-password-first-login\\page.tsx"],c="/change-password-first-login/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/change-password-first-login/page",pathname:"/change-password-first-login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},54350:(e,s,t)=>{Promise.resolve().then(t.bind(t,6402))},35303:()=>{},8428:(e,s,t)=>{"use strict";var r=t(14767);t.o(r,"useParams")&&t.d(s,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(s,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},6402:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(95344),a=t(3729),n=t(8428),o=t(66700),i=t(25750),l=t(31791),d=t(34034),c=t(44669);function u(){let e=(0,n.useRouter)(),{isAuthenticated:s,isLoading:t}=(0,o.a)(),[u,m]=(0,a.useState)(!1),[h,p]=(0,a.useState)({newPassword:"",confirmPassword:""}),[g,f]=(0,a.useState)({}),[x,w]=(0,a.useState)("weak"),[b,y]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t||s||e.push("/login")},[s,t,e]);let P=e=>{if(e.length<8)return"weak";let s=/[A-Z]/.test(e),t=[s,/[a-z]/.test(e),/\d/.test(e),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)].filter(Boolean).length;return t>=3?"strong":t>=2?"medium":"weak"},j=e=>{let{name:s,value:t}=e.target;p(e=>({...e,[s]:t})),"newPassword"===s&&w(P(t)),g[s]&&f(e=>({...e,[s]:""}))},v=()=>{let e={};return h.newPassword?h.newPassword.length<8&&(e.newPassword="Senha deve ter no m\xednimo 8 caracteres"):e.newPassword="Nova senha \xe9 obrigat\xf3ria",h.confirmPassword?h.newPassword!==h.confirmPassword&&(e.confirmPassword="As senhas n\xe3o correspondem"):e.confirmPassword="Confirma\xe7\xe3o de senha \xe9 obrigat\xf3ria",f(e),0===Object.keys(e).length},N=async s=>{if(s.preventDefault(),v())try{m(!0);let s=(0,i.hP)();if(!s){c.default.error("Sess\xe3o expirada. Fa\xe7a login novamente."),e.push("/login");return}await (0,l.LH)(s,h.newPassword),c.default.success("Senha alterada com sucesso!"),(0,i.DH)(),e.push("/login?passwordChanged=true")}catch(t){console.error("Erro ao alterar senha:",t);let s=t instanceof Error?t.message:"Falha ao alterar senha";s.includes("already")||s.includes("j\xe1")?(c.default.error("Voc\xea j\xe1 alterou sua senha. Fa\xe7a login novamente."),(0,i.DH)(),e.push("/login")):c.default.error(s)}finally{m(!1)}};return t?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Carregando..."})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-white rounded-lg shadow-lg p-8",children:[(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-center text-3xl font-extrabold text-gray-900",children:"Alterar Senha"}),r.jsx("p",{className:"mt-2 text-center text-gray-600 text-sm",children:"Esta \xe9 sua primeira vez acessando. Por favor, altere sua senha para continuar."})]}),(0,r.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:N,children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nova Senha"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("input",{id:"newPassword",name:"newPassword",type:b?"text":"password",value:h.newPassword,onChange:j,placeholder:"Digite sua nova senha",className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm ${g.newPassword?"border-red-500":"border-gray-300"}`,required:!0}),r.jsx("button",{type:"button",onClick:()=>y(!b),className:"absolute right-3 top-2.5 text-gray-500 hover:text-gray-700",children:b?"\uD83D\uDC41️":"\uD83D\uDC41️‍\uD83D\uDDE8️"})]}),g.newPassword&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.newPassword}),h.newPassword&&(0,r.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:`h-2 rounded-full transition-all ${(()=>{switch(x){case"strong":return"bg-green-500";case"medium":return"bg-yellow-500";case"weak":return"bg-red-500"}})()} ${(()=>{switch(x){case"strong":return"w-full";case"medium":return"w-2/3";case"weak":return"w-1/3"}})()}`})}),r.jsx("span",{className:"text-xs font-medium text-gray-600 w-12",children:(()=>{switch(x){case"strong":return"Forte";case"medium":return"M\xe9dia";case"weak":return"Fraca"}})()})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"M\xednimo 8 caracteres. Recomendado: mai\xfasculas, min\xfasculas, n\xfameros e s\xedmbolos."})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Senha"}),r.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:b?"text":"password",value:h.confirmPassword,onChange:j,placeholder:"Confirme sua nova senha",className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm ${g.confirmPassword?"border-red-500":"border-gray-300"}`,required:!0}),g.confirmPassword&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.confirmPassword})]})]}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,r.jsxs)("p",{className:"text-xs text-blue-800",children:[r.jsx("strong",{children:"Dica de seguran\xe7a:"})," Use uma senha forte com letras mai\xfasculas, min\xfasculas, n\xfameros e s\xedmbolos."]})}),r.jsx(d.z,{type:"submit",variant:"primary",fullWidth:!0,loading:u,disabled:u,children:u?"Alterando...":"Alterar Senha"})]})]})})}},66700:(e,s,t)=>{"use strict";t.d(s,{a:()=>o});var r=t(3729),a=t(8428),n=t(25750);let o=()=>{let e=(0,a.useRouter)(),[s,t]=(0,r.useState)(null),[o,i]=(0,r.useState)(!0),[l,d]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{(()=>{let s=(0,n.hP)(),r=(0,n.PR)();s&&r?(0,n.pw)(s)?((0,n.DH)(),t(null),d(!1),e.push("/login")):(t(r),d(!0)):(t(null),d(!1)),i(!1)})()},[e]),{user:s,isLoading:o,isAuthenticated:l,logout:()=>{(0,n.DH)(),t(null),d(!1),e.push("/login")}}}},31791:(e,s,t)=>{"use strict";t.d(s,{LH:()=>d,a$:()=>i,c0:()=>o,checkPasswordChange:()=>l,gF:()=>n,x4:()=>a});let r="http://localhost:4000",a=async e=>{let s=await fetch(`${r}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json().catch(()=>({message:"Login failed"}))).message||"Invalid credentials");return s.json()},n=async e=>{let s=await fetch(`${r}/api/auth/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json().catch(()=>({message:"Request failed"}))).message||"Failed to send password reset email")},o=async e=>{let s=await fetch(`${r}/api/auth/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json().catch(()=>({message:"Reset failed"}))).message||"Failed to reset password")};async function i(e){let s=await fetch(`${r}/api/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).error||"Failed to register user");return(await s.json()).user}async function l(e){let s=await fetch(`${r}/api/auth/check-password-change`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!s.ok)throw Error((await s.json().catch(()=>({message:"Check failed"}))).message||"Failed to check password change requirement");return s.json()}async function d(e,s){let t=await fetch(`${r}/api/auth/change-password-first-login`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({newPassword:s})});if(!t.ok)throw Error((await t.json().catch(()=>({message:"Change failed"}))).message||"Failed to change password");return t.json()}},25750:(e,s,t)=>{"use strict";t.d(s,{DH:()=>i,PR:()=>o,av:()=>n,hP:()=>a,pw:()=>d,vD:()=>r});let r=e=>{},a=()=>null,n=e=>{},o=()=>null,i=()=>{},l=e=>{try{let s=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),t=decodeURIComponent(atob(s).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(t)}catch{return null}},d=e=>{let s=l(e);if(!s||!s.exp)return!0;let t=Date.now()/1e3;return s.exp<t}},94072:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});var r=t(25036);function a({children:e}){return r.jsx(r.Fragment,{children:e})}t(40002)},560:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>n,__esModule:()=>a,default:()=>o});let r=(0,t(86843).createProxy)(String.raw`C:\Users\guilherme.almeida\Documents\GitHub\Gestao-Atletas-front\src\app\change-password-first-login\page.tsx`),{__esModule:a,$$typeof:n}=r,o=r.default}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[160,454],()=>t(55137));module.exports=r})();