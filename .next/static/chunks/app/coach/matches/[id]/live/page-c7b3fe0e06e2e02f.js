(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[54],{22150:function(e,t,a){Promise.resolve().then(a.bind(a,43278))},43278:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var s=a(3827),l=a(64090),o=a(47907),n=a(37269),i=a(86782),r=a(98793);let c={reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4};var d=a(94065),u=a(66651),m=a(57418),x=a(48584),h=a(70492),g=a(10963);let v=[{type:"SERVE",label:"Saque",icon:"\uD83C\uDFD0",color:"bg-cyan-500 hover:bg-cyan-600",results:[{value:"ACE",label:"Ace"},{value:"SERVE_IN",label:"Em jogo"},{value:"SERVE_ERROR",label:"Erro"}]},{type:"ATTACK",label:"Ataque",icon:"⚡",color:"bg-orange-500 hover:bg-orange-600",results:[{value:"ATTACK_POINT",label:"Ponto"},{value:"ATTACK_BLOCKED",label:"Bloqueado"},{value:"ATTACK_ERROR",label:"Erro"}]},{type:"BLOCK",label:"Bloqueio",icon:"\uD83D\uDEE1️",color:"bg-indigo-500 hover:bg-indigo-600",results:[{value:"BLOCK_POINT",label:"Ponto"},{value:"BLOCK_TOUCH",label:"Toque"},{value:"BLOCK_MISS",label:"Falha"}]},{type:"RECEPTION",label:"Recep\xe7\xe3o",icon:"\uD83D\uDCE5",color:"bg-emerald-500 hover:bg-emerald-600",results:[{value:"RECEPTION_A",label:"Excelente (A)"},{value:"RECEPTION_B",label:"Boa (B)"},{value:"RECEPTION_C",label:"Regular (C)"},{value:"RECEPTION_D",label:"Falha (D)"}]},{type:"DEFENSE",label:"Defesa",icon:"\uD83D\uDD30",color:"bg-rose-500 hover:bg-rose-600",results:[{value:"DEFENSE_SUCCESS",label:"Sucesso"},{value:"DEFENSE_FAIL",label:"Falha"}]}];function f(){let e=(0,o.useRouter)(),{id:t}=(0,o.useParams)(),{user:a}=(0,n.a)(),[f,y]=(0,l.useState)(null),[b,N]=(0,l.useState)(null),[j,C]=(0,l.useState)([]),[w,T]=(0,l.useState)(null),[R,_]=(0,l.useState)([]),[A,k]=(0,l.useState)(!0),[I,O]=(0,l.useState)(!1),[D,z]=(0,l.useState)(!1),[P,U]=(0,l.useState)(!1),[F,L]=(0,l.useState)(!1),[B,K]=(0,l.useState)(!1),[V,W]=(0,l.useState)(null),M=(e,t,a)=>{var s;if(!f||!b)return;let l={SERVE:{ACE:"home",SERVE_ERROR:"away",SERVE_IN:null},ATTACK:{ATTACK_POINT:"home",ATTACK_ERROR:"away",ATTACK_BLOCKED:"away"},BLOCK:{BLOCK_POINT:"home",BLOCK_TOUCH:null,BLOCK_MISS:"away"},RECEPTION:{RECEPTION_A:null,RECEPTION_B:null,RECEPTION_C:null,RECEPTION_D:"away"},DEFENSE:{DEFENSE_SUCCESS:null,DEFENSE_FAIL:"away"},SET:{SET_SUCCESS:null,SET_ERROR:"away"}}[e];if(!l)return;let o=l[t];if(null===o)return;let n=(null==w?void 0:w.teamId)===(null==f?void 0:null===(s=f.homeTeam)||void 0===s?void 0:s.id),i=b.homeScore,r=b.awayScore;"home"===o?n?i+=1:r+=1:"away"===o&&(n?r+=1:i+=1),N(e=>e?{...e,homeScore:i,awayScore:r}:null)};(0,l.useEffect)(()=>{(async()=>{try{k(!0);let[e,a]=await Promise.all([(0,d.$P)(t),(0,d.nz)(t)]);y(e),C(a);let s=a.find(e=>"IN_PROGRESS"===e.status)||a[a.length-1];N(s),t&&q(t)}catch(e){console.error("Erro ao carregar partida:",e),g.default.error("Falha ao carregar os dados da partida")}finally{k(!1)}})()},[t]);let q=(0,l.useCallback)(async e=>{if(e)try{console.log("Carregando estat\xedsticas para a partida:",e);let t=await (0,d.Hd)(e);console.log("Estat\xedsticas recebidas:",t),t&&t.matchStatistics?W(t):console.warn("Estat\xedsticas vazias ou inv\xe1lidas recebidas:",t)}catch(t){console.error("Erro ao carregar estat\xedsticas:",t),console.error("Detalhes do erro:",{matchId:e,errorMessage:t instanceof Error?t.message:"Erro desconhecido",errorStack:t instanceof Error?t.stack:void 0})}},[]),{error:H}=function(e,t){let a=(0,l.useRef)(null),[s,o]=(0,l.useState)({isConnected:!1,isConnecting:!1,error:null,reconnectAttempt:0}),n=(0,l.useRef)(t);(0,l.useEffect)(()=>{n.current=t},[t]);let d=(0,l.useCallback)(()=>{if(!e)return;let t=(0,r.hP)();if(!t){o(e=>({...e,error:"No authentication token available",isConnecting:!1}));return}if((0,r.pw)(t)){o(e=>({...e,error:"Authentication token expired. Please log in again.",isConnecting:!1}));return}o(e=>({...e,isConnecting:!0,error:null}));let s=(0,i.io)("http://localhost:4000",{auth:{token:t},path:"/socket.io",transports:["websocket","polling"],...c});a.current=s,s.on("connect",()=>{console.log("WebSocket connected, Socket ID:",s.id),o({isConnected:!0,isConnecting:!1,error:null,reconnectAttempt:0}),s.emit("join_match",{matchId:e})}),s.on("disconnect",e=>{console.log("WebSocket disconnected:",e),o(e=>({...e,isConnected:!1,isConnecting:!1}))}),s.on("connect_error",e=>{console.error("WebSocket connection error:",e.message),o(t=>({...t,error:e.message,isConnected:!1,isConnecting:!1}))}),s.io.on("reconnect_attempt",e=>{console.log("WebSocket reconnection attempt ".concat(e)),o(t=>({...t,reconnectAttempt:e,isConnecting:!0}))}),s.io.on("reconnect",e=>{console.log("WebSocket reconnected after ".concat(e," attempts")),o({isConnected:!0,isConnecting:!1,error:null,reconnectAttempt:0})}),s.io.on("reconnect_error",e=>{console.error("WebSocket reconnection error:",e.message),o(t=>({...t,error:"Reconnection failed: ".concat(e.message)}))}),s.io.on("reconnect_failed",()=>{console.error("WebSocket reconnection failed after maximum attempts"),o(e=>({...e,error:"Failed to reconnect after maximum attempts",isConnecting:!1}))}),s.on("match_joined",e=>{var t,a;console.log("Successfully joined match room:",e),null===(a=n.current)||void 0===a||null===(t=a.onMatchJoined)||void 0===t||t.call(a,e)}),s.on("match_left",e=>{var t,a;console.log("Successfully left match room:",e),null===(a=n.current)||void 0===a||null===(t=a.onMatchLeft)||void 0===t||t.call(a,e)}),s.on("user_joined",e=>{var t,a;console.log("User joined match room:",e),null===(a=n.current)||void 0===a||null===(t=a.onUserJoined)||void 0===t||t.call(a,e)}),s.on("user_left",e=>{var t,a;console.log("User left match room:",e),null===(a=n.current)||void 0===a||null===(t=a.onUserLeft)||void 0===t||t.call(a,e)}),s.on("action_registered",e=>{var t,a;console.log("Action registered:",e),null===(a=n.current)||void 0===a||null===(t=a.onActionRegistered)||void 0===t||t.call(a,e)}),s.on("set_finalized",e=>{var t,a;console.log("Set finalized:",e),null===(a=n.current)||void 0===a||null===(t=a.onSetFinalized)||void 0===t||t.call(a,e)}),s.on("match_finalized",e=>{var t,a;console.log("Match finalized:",e),null===(a=n.current)||void 0===a||null===(t=a.onMatchFinalized)||void 0===t||t.call(a,e)}),s.on("live_statistics_update",e=>{var t,a;console.log("Live statistics update:",e),null===(a=n.current)||void 0===a||null===(t=a.onLiveStatisticsUpdate)||void 0===t||t.call(a,e)}),s.on("set_score_updated",e=>{var t,a;console.log("Set score updated:",e),null===(a=n.current)||void 0===a||null===(t=a.onSetScoreUpdated)||void 0===t||t.call(a,e)}),s.on("action_undone",e=>{var t,a;console.log("Action undone:",e),null===(a=n.current)||void 0===a||null===(t=a.onActionUndone)||void 0===t||t.call(a,e)})},[e]),u=(0,l.useCallback)(()=>{a.current&&(e&&a.current.emit("leave_match",{matchId:e}),a.current.disconnect(),a.current=null,o({isConnected:!1,isConnecting:!1,error:null,reconnectAttempt:0}))},[e]),m=(0,l.useCallback)(()=>{u(),setTimeout(()=>{d()},100)},[d,u]);(0,l.useEffect)(()=>(e&&d(),()=>{u()}),[e,d,u]);let x=(0,l.useCallback)((e,t)=>{a.current&&a.current.on(e,t)},[]),h=(0,l.useCallback)((e,t)=>{a.current&&a.current.off(e,t)},[]),g=(0,l.useCallback)((e,t)=>{a.current&&s.isConnected?a.current.emit(e,t):console.warn('Cannot emit event "'.concat(e,'": WebSocket not connected'))},[s.isConnected]);return{socket:a.current,isConnected:s.isConnected,isConnecting:s.isConnecting,error:s.error,reconnectAttempt:s.reconnectAttempt,connect:d,disconnect:u,reconnect:m,on:x,off:h,emit:g}}(t,{onActionRegistered:e=>{if(console.log("=== ACTION REGISTERED EVENT DEBUG ==="),console.log("Full event data:",JSON.stringify(e,null,2)),console.log("Action data:",e.action),console.log("Updated statistics:",e.updatedStatistics),console.log("Has updatedStatistics:",!!e.updatedStatistics),e.updatedStatistics){var a;console.log("Statistics structure:",{hasCurrentSet:!!e.updatedStatistics.currentSet,hasCurrentSetStatistics:!!e.updatedStatistics.currentSetStatistics,hasMatchStatistics:!!e.updatedStatistics.matchStatistics,teamStats:null===(a=e.updatedStatistics.matchStatistics)||void 0===a?void 0:a.teamStatistics})}e.updatedStatistics?(console.log("Using updated statistics from WebSocket event:",e.updatedStatistics),W(e.updatedStatistics)):(console.log("No updated statistics in event, loading from server"),q(t)),e.updatedStatistics&&console.log("Stats updated from WebSocket, forcing UI update"),console.log("Adding to action logs..."),console.log("Current selectedPlayer:",w),console.log("Action data:",e.action),_(t=>{var a,s,l,o,n,i;console.log("Previous action logs:",t);let r={id:(null===(a=e.action)||void 0===a?void 0:a.id)||Date.now().toString(),type:(null===(s=e.action)||void 0===s?void 0:s.actionType)||"UNKNOWN",result:(null===(l=e.action)||void 0===l?void 0:l.result)||"UNKNOWN",player:(null===(o=e.action)||void 0===o?void 0:o.athleteName)?{id:(null===(n=e.action)||void 0===n?void 0:n.athleteId)||"",name:e.action.athleteName,jerseyNumber:(null===(i=e.action)||void 0===i?void 0:i.athleteJerseyNumber)||0,position:"OUTSIDE_HITTER",userId:"",teamId:"",isActive:!0}:w||{id:"",name:"Unknown",jerseyNumber:0,position:"OUTSIDE_HITTER",userId:"",teamId:"",isActive:!0},timestamp:new Date(e.timestamp),setNumber:(null==b?void 0:b.setNumber)||1};console.log("New action log created:",r);let c=[r,...t];return console.log("Updated action logs length:",c.length),console.log("Updated action logs:",c),c}),console.log("=== END ACTION REGISTERED EVENT DEBUG ===")},onSetFinalized:e=>{g.default.success("Set finalizado"),t&&(0,d.nz)(t).then(e=>{C(e);let t=e.find(e=>e.id===(null==b?void 0:b.id));t&&N(t)})},onMatchFinalized:a=>{g.default.success("Partida finalizada"),e.push("/coach/matches/".concat(t,"/finalize"))},onLiveStatisticsUpdate:e=>{e.liveStatistics&&e.liveStatistics.matchStatistics&&(console.log("Updating statistics from WebSocket event"),W(e.liveStatistics),console.log("Stats updated from live statistics event, forcing UI update"))},onSetScoreUpdated:e=>{console.log("Set score update received:",e),console.log("Current set ID:",null==b?void 0:b.id),console.log("Data set ID:",e.setId),b&&e.setId===b.id?(console.log("Updating set scores:",{old:{home:b.homeScore,away:b.awayScore},new:{home:e.homeScore,away:e.awayScore}}),N(t=>t?{...t,homeScore:e.homeScore,awayScore:e.awayScore}:null)):console.log("Set ID mismatch or no current set")},onActionUndone:e=>{e.updatedStatistics?(console.log("Using updated statistics from action_undone event:",e.updatedStatistics),W(e.updatedStatistics)):(console.log("No updated statistics in action_undone event, loading from server"),q(t)),e.updatedStatistics&&console.log("Stats updated from WebSocket after undo, forcing UI update"),_(e=>e.slice(1)),g.default.success("A\xe7\xe3o desfeita com sucesso")}});(0,l.useEffect)(()=>{H?(console.error("Erro na conex\xe3o WebSocket:",H),g.default.error("Erro na conex\xe3o em tempo real. Atualize a p\xe1gina para tentar novamente.")):t&&!A&&(console.log("WebSocket reconnected, reloading statistics"),q(t))},[H,t,A,q]);let G=async(e,a)=>{if(!w||!b){g.default.error("Selecione um jogador primeiro");return}try{O(!0),M(e,a,w.id),await (0,d.zl)({matchId:t,athleteId:w.id,actionType:e,result:a,setId:b.id}),g.default.success("A\xe7\xe3o registrada com sucesso"),setTimeout(()=>{q(t)},100)}catch(e){console.error("Erro ao registrar a\xe7\xe3o:",e),g.default.error("Falha ao registrar a a\xe7\xe3o"),q(t)}finally{O(!1)}},J=async()=>{if(!b||0===R.length){g.default.error("Nenhuma a\xe7\xe3o para desfazer");return}try{O(!0),await (0,d.Rt)(t),q(t),_(e=>e.slice(1)),g.default.success("A\xe7\xe3o desfeita com sucesso")}catch(e){console.error("Erro ao desfazer a\xe7\xe3o:",e),g.default.error("Falha ao desfazer a a\xe7\xe3o")}finally{O(!1)}},Z=async()=>{if(b)try{O(!0),await (0,d.rA)(b.id),U(!1);let[e,a]=await Promise.all([(0,d.$P)(t),(0,d.nz)(t)]);y(e),C(a),N(a.find(e=>e.id===b.id)||null),g.default.success("Set finalizado com sucesso")}catch(e){console.error("Erro ao finalizar set:",e),g.default.error("Falha ao finalizar o set")}finally{O(!1)}},$=async()=>{if(f)try{if(O(!0),console.log("Creating new set for match:",f.id,"Current status:",f.status),"SCHEDULED"===f.status){console.log("Match is SCHEDULED, starting match first..."),await (0,d.Wo)(f.id),console.log("Match started successfully");let e=await (0,d.$P)(f.id);console.log("Updated match status:",e.status),y(e);let t=await (0,d.nz)(f.id);C(t);let a=t.find(e=>"IN_PROGRESS"===e.status);N(a||null),g.default.success("Partida iniciada com sucesso"),K(!1);return}if(j.find(e=>"IN_PROGRESS"===e.status)){console.log("There is already an active set, cannot create new set"),g.default.error("J\xe1 existe um set em andamento. Finalize o set atual antes de criar um novo."),K(!1);return}console.log("Now creating set for match:",f.id);let e=await (0,d.Jx)(f.id);console.log("Set created successfully:",e);let t=e.set;C(e=>[...e,t]),N(t),K(!1),_([]),g.default.success("Novo set iniciado")}catch(e){console.error("Erro ao criar novo set:",e),console.error("Error details:",{matchId:f.id,matchStatus:f.status,errorMessage:e instanceof Error?e.message:"Erro desconhecido",errorStack:e instanceof Error?e.stack:void 0}),g.default.error("Falha ao criar novo set")}finally{O(!1)}},Q=async()=>{if(f)try{O(!0),await (0,d.ig)(f.id),L(!1),e.push("/coach/matches/".concat(f.id,"/finalize"))}catch(e){console.error("Erro ao finalizar partida:",e),g.default.error("Falha ao finalizar a partida")}finally{O(!1)}},X=(null==b?void 0:b.status)==="IN_PROGRESS";return A?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Carregando partida..."})]})}):f?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 py-2 sm:py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between flex-col sm:flex-row gap-2 sm:gap-0",children:[(0,s.jsxs)("div",{className:"w-full sm:w-auto",children:[(0,s.jsxs)(u.z,{variant:"ghost",size:"sm",onClick:()=>e.push("/coach/matches"),className:"text-gray-600 hover:bg-gray-100 text-xs sm:text-sm",children:[(0,s.jsx)("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Voltar"]}),(0,s.jsxs)("h1",{className:"text-base sm:text-xl font-bold text-gray-900 mt-1 truncate",children:[f.homeTeam.name," ",(0,s.jsx)("span",{className:"text-gray-400",children:"x"})," ",f.awayTeam.name]}),(0,s.jsxs)("div",{className:"flex items-center text-xs sm:text-sm text-gray-500 flex-wrap",children:[(0,s.jsxs)("span",{children:["Set ",null==b?void 0:b.setNumber," de 5"]}),f.location&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"mx-1 sm:mx-2",children:"•"}),(0,s.jsx)("span",{className:"truncate",children:f.location})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-1 sm:gap-2 w-full sm:w-auto flex-wrap sm:flex-nowrap",children:[X&&(0,s.jsx)(u.z,{variant:"outline",onClick:J,disabled:I||0===R.length,size:"sm",className:"text-xs sm:text-sm flex-1 sm:flex-none",children:"Desfazer"}),X?(0,s.jsx)(u.z,{variant:"outline",onClick:()=>U(!0),disabled:I,size:"sm",className:"text-xs sm:text-sm flex-1 sm:flex-none",children:"Finalizar Set"}):(0,s.jsx)(u.z,{variant:"primary",onClick:()=>K(!0),disabled:I,size:"sm",className:"text-xs sm:text-sm flex-1 sm:flex-none",children:"Novo Set"}),(0,s.jsx)(u.z,{variant:"danger",onClick:()=>L(!0),disabled:I,size:"sm",className:"text-xs sm:text-sm flex-1 sm:flex-none",children:"Finalizar"})]})]})})}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-2 sm:px-4 py-3 sm:py-6",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden mb-4 sm:mb-6",children:(0,s.jsx)("div",{className:"px-3 sm:px-6 py-3 sm:py-5",children:(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 items-center",children:[(0,s.jsx)(p,{team:f.homeTeam,score:(null==b?void 0:b.homeScore)||0,isServing:(null==b?void 0:b.servingTeam)===f.homeTeam.id,isWinning:((null==b?void 0:b.homeScore)||0)>((null==b?void 0:b.awayScore)||0)}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-2xl sm:text-4xl font-bold text-gray-900",children:[null==b?void 0:b.homeScore," - ",null==b?void 0:b.awayScore]}),(0,s.jsxs)("div",{className:"text-xs sm:text-sm text-gray-500",children:["Set ",null==b?void 0:b.setNumber]}),(0,s.jsx)("div",{className:"mt-1 sm:mt-2",children:(0,s.jsx)(x.C,{variant:X?"success":"default",size:"sm",children:X?"Em andamento":"Finalizado"})})]}),(0,s.jsx)(p,{team:f.awayTeam,score:(null==b?void 0:b.awayScore)||0,isServing:(null==b?void 0:b.servingTeam)===f.awayTeam.id,isWinning:((null==b?void 0:b.awayScore)||0)>((null==b?void 0:b.homeScore)||0),alignRight:!0})]})})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3 sm:gap-6",children:[(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-3 sm:space-y-6",children:[(0,s.jsx)(m.Z,{title:"Jogador em A\xe7\xe3o",subtitle:w?"Selecionado: ".concat(w.name," (").concat(w.jerseyNumber,")"):"Selecione um jogador para registrar a\xe7\xf5es",children:(0,s.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2",children:f.athletes.map(e=>(0,s.jsx)("button",{onClick:()=>T(e),className:"p-2 sm:p-3 rounded-lg border-2 transition-all text-xs sm:text-sm ".concat((null==w?void 0:w.id)===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"font-medium text-black truncate",children:e.name}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:["#",e.jerseyNumber]})]})},e.id))})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-6",children:[(0,s.jsx)(m.Z,{title:"Ofensiva",subtitle:"A\xe7\xf5es de ataque e saque",children:(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:v.filter(e=>["SERVE","ATTACK"].includes(e.type)).map(e=>(0,s.jsx)(S,{button:e,onClick:t=>G(e.type,t),disabled:!w||I},e.type))})}),(0,s.jsx)(m.Z,{title:"Defesa",subtitle:"A\xe7\xf5es defensivas e recep\xe7\xe3o",children:(0,s.jsx)("div",{className:"grid grid-cols-3 gap-2",children:v.filter(e=>!["SERVE","ATTACK"].includes(e.type)).map(e=>(0,s.jsx)(S,{button:e,onClick:t=>G(e.type,t),disabled:!w||I},e.type))})})]})]}),(0,s.jsxs)("div",{className:"space-y-3 sm:space-y-6",children:[(0,s.jsx)(m.Z,{title:"Estat\xedsticas",subtitle:"Resumo da partida",children:V?(0,s.jsxs)("div",{className:"space-y-2 sm:space-y-4 text-xs sm:text-sm text-black",children:[(0,s.jsx)(E,{label:"Pontos",homeValue:V.matchStatistics.teamStatistics.totalPoints||0,awayValue:0}),(0,s.jsx)(E,{label:"Bloqueios",homeValue:V.matchStatistics.teamStatistics.blockPoints||0,awayValue:0}),(0,s.jsx)(E,{label:"Efici\xeancia de Ataque",homeValue:Math.round(V.matchStatistics.teamStatistics.attackEfficiency||0),awayValue:0}),(0,s.jsx)(E,{label:"Efici\xeancia de Saque",homeValue:Math.round(V.matchStatistics.teamStatistics.serveEfficiency||0),awayValue:0}),(0,s.jsx)(E,{label:"Qualidade de Recep\xe7\xe3o",homeValue:Math.round(V.matchStatistics.teamStatistics.receptionQuality||0),awayValue:0}),(0,s.jsx)(E,{label:"Erros",homeValue:V.matchStatistics.teamStatistics.totalErrors||0,awayValue:0,isError:!0})]}):(0,s.jsx)("div",{className:"text-center py-4 text-gray-500 text-xs sm:text-sm",children:"Carregando estat\xedsticas..."})}),(0,s.jsx)(m.Z,{title:"Hist\xf3rico",subtitle:"\xdaltimas a\xe7\xf5es",children:(0,s.jsx)("div",{className:"space-y-1 max-h-64 sm:max-h-96 overflow-y-auto pr-2 text-xs sm:text-sm",children:R.length>0?R.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start p-1 sm:p-2 hover:bg-gray-50 rounded-lg",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-2 h-2 mt-1 rounded-full bg-blue-500"}),(0,s.jsxs)("div",{className:"ml-2",children:[(0,s.jsxs)("div",{className:"font-medium text-gray-900 truncate",children:[e.player.name," ",(0,s.jsx)("span",{className:"text-gray-500",children:"•"})," ",(0,s.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,s.jsx)("div",{className:"text-gray-600",children:function(e,t){var a;let s=v.find(t=>t.type===e);if(!s){let a={ACE:"Ace",SERVE_IN:"Em jogo",SERVE_ERROR:"Erro",ATTACK_POINT:"Ponto",ATTACK_ERROR:"Erro",ATTACK_BLOCKED:"Bloqueado",BLOCK_POINT:"Ponto",BLOCK_TOUCH:"Toque",BLOCK_MISS:"Falha",RECEPTION_A:"Excelente (A)",RECEPTION_B:"Boa (B)",RECEPTION_C:"Regular (C)",RECEPTION_D:"Falha (D)",DEFENSE_SUCCESS:"Sucesso",DEFENSE_FAIL:"Falha",SET_SUCCESS:"Sucesso",SET_ERROR:"Erro"}[t]||t;return"".concat({SERVE:"Saque",ATTACK:"Ataque",BLOCK:"Bloqueio",RECEPTION:"Recep\xe7\xe3o",DEFENSE:"Defesa",SET:"Levantamento",ROTATION:"Rota\xe7\xe3o",SUBSTITUTION:"Substitui\xe7\xe3o"}[e]||e," • ").concat(a)}let l=null===(a=s.results.find(e=>e.value===t))||void 0===a?void 0:a.label;return"".concat(s.label," • ").concat(l||t)}(e.type,e.result)})]})]},"".concat(e.id,"-").concat(t))):(0,s.jsx)("div",{className:"text-center py-4 text-gray-500",children:"Nenhuma a\xe7\xe3o registrada"})})})]})]})]}),(0,s.jsx)(h.u,{isOpen:P,onClose:()=>U(!1),title:"Finalizar Set",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-gray-600",children:"Tem certeza que deseja finalizar o set atual? O placar ser\xe1 mantido."}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,s.jsx)(u.z,{variant:"outline",onClick:()=>U(!1),disabled:I,children:"Cancelar"}),(0,s.jsx)(u.z,{variant:"primary",onClick:Z,loading:I,children:"Confirmar"})]})]})}),(0,s.jsx)(h.u,{isOpen:F,onClose:()=>L(!1),title:"Finalizar Partida",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-gray-600",children:"Tem certeza que deseja finalizar a partida? Voc\xea ser\xe1 redirecionado para a p\xe1gina de resumo."}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,s.jsx)(u.z,{variant:"outline",onClick:()=>L(!1),disabled:I,children:"Cancelar"}),(0,s.jsx)(u.z,{variant:"danger",onClick:Q,loading:I,children:"Finalizar Partida"})]})]})}),(0,s.jsx)(h.u,{isOpen:B,onClose:()=>K(!1),title:"Iniciar Novo Set",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-gray-600",children:(null==f?void 0:f.status)==="SCHEDULED"?"A partida ser\xe1 iniciada e o set ".concat(j.length+1," come\xe7ar\xe1."):"Iniciar o set ".concat(j.length+1," da partida?")}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,s.jsx)(u.z,{variant:"outline",onClick:()=>K(!1),disabled:I,children:"Cancelar"}),(0,s.jsx)(u.z,{variant:"primary",onClick:$,loading:I,children:(null==f?void 0:f.status)==="SCHEDULED"?"Iniciar Partida":"Iniciar Set"})]})]})})]}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Partida n\xe3o encontrada"}),(0,s.jsx)(u.z,{onClick:()=>e.push("/coach/matches"),children:"Voltar para partidas"})]})})}function p(e){let{team:t,score:a,isServing:l,isWinning:o,alignRight:n=!1}=e;return(0,s.jsxs)("div",{className:n?"text-right":"",children:[(0,s.jsxs)("div",{className:"flex items-center",style:n?{justifyContent:"flex-end"}:{},children:[!n&&l&&(0,s.jsx)("span",{className:"text-yellow-500 mr-2 text-sm",children:"●"}),(0,s.jsx)("h3",{className:"text-lg font-medium ".concat(o?"text-green-600":"text-gray-900"),children:t.shortName||t.name}),n&&l&&(0,s.jsx)("span",{className:"text-yellow-500 ml-2 text-sm",children:"●"})]}),(0,s.jsx)("div",{className:"text-4xl font-black mt-1 ".concat(o?"text-green-600":"text-gray-900"),children:a})]})}function S(e){let{button:t,onClick:a,disabled:l=!1}=e;return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("button",{onClick:()=>a(t.results[0].value),disabled:l,className:"w-full py-3 px-2 rounded-lg text-white font-medium ".concat(t.color," transition-all ").concat(l?"opacity-50 cursor-not-allowed":"hover:opacity-90"),children:(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-2xl mb-1",children:t.icon}),(0,s.jsx)("span",{children:t.label})]})}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:t.results.slice(1).map(e=>(0,s.jsx)("button",{onClick:()=>a(e.value),disabled:l,className:"text-xs py-1.5 px-2 bg-gray-700 hover:bg-gray-900 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.label},e.value))})]})}function E(e){let{label:t,homeValue:a,awayValue:l,isError:o=!1}=e,n=a+l,i=n>0?a/n*100:50;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,s.jsx)("span",{className:"font-medium",children:t}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:o?"text-red-500":"text-blue-500",children:a})," - ",(0,s.jsx)("span",{className:o?"text-red-500":"text-blue-500",children:l})]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"h-full rounded-full ".concat(o?"bg-red-500":"bg-blue-500"),style:{width:"".concat(i,"%")}})})]})}},48584:function(e,t,a){"use strict";a.d(t,{C:function(){return l}});var s=a(3827);a(64090);let l=e=>{let{children:t,variant:a="default",size:l="md",className:o=""}=e;return(0,s.jsx)("span",{className:"inline-flex items-center font-medium rounded-full ".concat({default:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",error:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800"}[a]," ").concat({sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-sm",lg:"px-3 py-1.5 text-base"}[l]," ").concat(o),children:t})}},70492:function(e,t,a){"use strict";a.d(t,{u:function(){return o}});var s=a(3827),l=a(64090);let o=e=>{let{isOpen:t,onClose:a,title:o,children:n,size:i="md"}=e,r=(0,l.useRef)(null);return((0,l.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t&&a()};return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,a]),t)?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 transition-opacity duration-300",onClick:e=>{e.target===e.currentTarget&&a()},role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:(0,s.jsxs)("div",{ref:r,className:"relative w-full ".concat({sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"}[i]," mx-4 bg-white rounded-lg shadow-xl transform transition-all duration-300 scale-100 opacity-100"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{id:"modal-title",className:"text-xl font-semibold text-gray-900",children:o}),(0,s.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsx)("div",{className:"p-6",children:n})]})}):null}}},function(e){e.O(0,[963,254,63,971,69,744],function(){return e(e.s=22150)}),_N_E=e.O()}]);