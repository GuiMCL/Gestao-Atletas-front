(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[586],{47327:function(e,t,r){Promise.resolve().then(r.bind(r,46331))},47907:function(e,t,r){"use strict";var a=r(15313);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},46331:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var a=r(3827),s=r(64090),n=r(47907),o=r(37269),c=r(98793),i=r(73884),l=r(66651),u=r(10963);function d(){let e=(0,n.useRouter)(),{isAuthenticated:t,isLoading:r}=(0,o.a)(),[d,m]=(0,s.useState)(!1),[h,g]=(0,s.useState)({newPassword:"",confirmPassword:""}),[f,w]=(0,s.useState)({}),[p,x]=(0,s.useState)("weak"),[b,y]=(0,s.useState)(!1);(0,s.useEffect)(()=>{r||t||e.push("/login")},[t,r,e]);let j=e=>{if(e.length<8)return"weak";let t=/[A-Z]/.test(e),r=[t,/[a-z]/.test(e),/\d/.test(e),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)].filter(Boolean).length;return r>=3?"strong":r>=2?"medium":"weak"},v=e=>{let{name:t,value:r}=e.target;g(e=>({...e,[t]:r})),"newPassword"===t&&x(j(r)),f[t]&&w(e=>({...e,[t]:""}))},P=()=>{let e={};return h.newPassword?h.newPassword.length<8&&(e.newPassword="Senha deve ter no m\xednimo 8 caracteres"):e.newPassword="Nova senha \xe9 obrigat\xf3ria",h.confirmPassword?h.newPassword!==h.confirmPassword&&(e.confirmPassword="As senhas n\xe3o correspondem"):e.confirmPassword="Confirma\xe7\xe3o de senha \xe9 obrigat\xf3ria",w(e),0===Object.keys(e).length},N=async t=>{if(t.preventDefault(),P())try{m(!0);let t=(0,c.hP)();if(!t){u.default.error("Sess\xe3o expirada. Fa\xe7a login novamente."),e.push("/login");return}await (0,i.LH)(t,h.newPassword),u.default.success("Senha alterada com sucesso!"),(0,c.DH)(),e.push("/login?passwordChanged=true")}catch(r){console.error("Erro ao alterar senha:",r);let t=r instanceof Error?r.message:"Falha ao alterar senha";t.includes("already")||t.includes("j\xe1")?(u.default.error("Voc\xea j\xe1 alterou sua senha. Fa\xe7a login novamente."),(0,c.DH)(),e.push("/login")):u.default.error(t)}finally{m(!1)}};return r?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Carregando..."})]})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-white rounded-lg shadow-lg p-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-center text-3xl font-extrabold text-gray-900",children:"Alterar Senha"}),(0,a.jsx)("p",{className:"mt-2 text-center text-gray-600 text-sm",children:"Esta \xe9 sua primeira vez acessando. Por favor, altere sua senha para continuar."})]}),(0,a.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:N,children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nova Senha"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{id:"newPassword",name:"newPassword",type:b?"text":"password",value:h.newPassword,onChange:v,placeholder:"Digite sua nova senha",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm ".concat(f.newPassword?"border-red-500":"border-gray-300"),required:!0}),(0,a.jsx)("button",{type:"button",onClick:()=>y(!b),className:"absolute right-3 top-2.5 text-gray-500 hover:text-gray-700",children:b?"\uD83D\uDC41️":"\uD83D\uDC41️‍\uD83D\uDDE8️"})]}),f.newPassword&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-500",children:f.newPassword}),h.newPassword&&(0,a.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all ".concat((()=>{switch(p){case"strong":return"bg-green-500";case"medium":return"bg-yellow-500";case"weak":return"bg-red-500"}})()," ").concat((()=>{switch(p){case"strong":return"w-full";case"medium":return"w-2/3";case"weak":return"w-1/3"}})())})}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600 w-12",children:(()=>{switch(p){case"strong":return"Forte";case"medium":return"M\xe9dia";case"weak":return"Fraca"}})()})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"M\xednimo 8 caracteres. Recomendado: mai\xfasculas, min\xfasculas, n\xfameros e s\xedmbolos."})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Senha"}),(0,a.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:b?"text":"password",value:h.confirmPassword,onChange:v,placeholder:"Confirme sua nova senha",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm ".concat(f.confirmPassword?"border-red-500":"border-gray-300"),required:!0}),f.confirmPassword&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-500",children:f.confirmPassword})]})]}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,a.jsxs)("p",{className:"text-xs text-blue-800",children:[(0,a.jsx)("strong",{children:"Dica de seguran\xe7a:"})," Use uma senha forte com letras mai\xfasculas, min\xfasculas, n\xfameros e s\xedmbolos."]})}),(0,a.jsx)(l.z,{type:"submit",variant:"primary",fullWidth:!0,loading:d,disabled:d,children:d?"Alterando...":"Alterar Senha"})]})]})})}},66651:function(e,t,r){"use strict";r.d(t,{z:function(){return s}});var a=r(3827);r(64090);let s=e=>{let{variant:t="primary",size:r="md",fullWidth:s=!1,loading:n=!1,disabled:o,children:c,className:i="",...l}=e;return(0,a.jsxs)("button",{className:"".concat("inline-flex items-center justify-center font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 touch-manipulation select-none"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500",outline:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus:ring-blue-500",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500"}[t]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[r]," ").concat(s?"w-full":""," ").concat(i),disabled:o||n,...l,children:[n&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c]})}},37269:function(e,t,r){"use strict";r.d(t,{a:function(){return o}});var a=r(64090),s=r(47907),n=r(98793);let o=()=>{let e=(0,s.useRouter)(),[t,r]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0),[i,l]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{(()=>{let t=(0,n.hP)(),a=(0,n.PR)();t&&a?(0,n.pw)(t)?((0,n.DH)(),r(null),l(!1),e.push("/login")):(r(a),l(!0)):(r(null),l(!1)),c(!1)})()},[e]),{user:t,isLoading:o,isAuthenticated:i,logout:()=>{(0,n.DH)(),r(null),l(!1),e.push("/login")}}}},73884:function(e,t,r){"use strict";r.d(t,{LH:function(){return l},a$:function(){return c},c0:function(){return o},checkPasswordChange:function(){return i},gF:function(){return n},x4:function(){return s}});let a="http://localhost:4000",s=async e=>{let t=await fetch("".concat(a,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json().catch(()=>({message:"Login failed"}))).message||"Invalid credentials");return t.json()},n=async e=>{let t=await fetch("".concat(a,"/api/auth/forgot-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json().catch(()=>({message:"Request failed"}))).message||"Failed to send password reset email")},o=async e=>{let t=await fetch("".concat(a,"/api/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json().catch(()=>({message:"Reset failed"}))).message||"Failed to reset password")};async function c(e){let t=await fetch("".concat(a,"/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Failed to register user");return(await t.json()).user}async function i(e){let t=await fetch("".concat(a,"/api/auth/check-password-change"),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok)throw Error((await t.json().catch(()=>({message:"Check failed"}))).message||"Failed to check password change requirement");return t.json()}async function l(e,t){let r=await fetch("".concat(a,"/api/auth/change-password-first-login"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({newPassword:t})});if(!r.ok)throw Error((await r.json().catch(()=>({message:"Change failed"}))).message||"Failed to change password");return r.json()}},98793:function(e,t,r){"use strict";r.d(t,{DH:function(){return u},PR:function(){return l},av:function(){return i},hP:function(){return c},pw:function(){return m},vD:function(){return o}});let a="volleyball_access_token",s="volleyball_refresh_token",n="volleyball_user",o=e=>{localStorage.setItem(a,e.accessToken),localStorage.setItem(s,e.refreshToken)},c=()=>localStorage.getItem(a),i=e=>{localStorage.setItem(n,JSON.stringify(e))},l=()=>{let e=localStorage.getItem(n);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}},u=()=>{localStorage.removeItem(a),localStorage.removeItem(s),localStorage.removeItem(n)},d=e=>{try{let t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(t).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(r)}catch(e){return null}},m=e=>{let t=d(e);if(!t||!t.exp)return!0;let r=Date.now()/1e3;return t.exp<r}}},function(e){e.O(0,[963,971,69,744],function(){return e(e.s=47327)}),_N_E=e.O()}]);